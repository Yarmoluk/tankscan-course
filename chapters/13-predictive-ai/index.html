
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive intelligent textbook on wireless tank monitoring technology, IoT systems, and the TankScan platform">
      
      
        <meta name="author" content="Daniel Yarmoluk">
      
      
      
        <link rel="prev" href="../12-cloud-integration/">
      
      
        <link rel="next" href="../14-case-studies/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>13. Predictive Maintenance and AI - TankScan Intelligent Textbook: Wireless Tank Monitoring Systems</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-13-predictive-maintenance-and-ai" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TankScan Intelligent Textbook: Wireless Tank Monitoring Systems" class="md-header__button md-logo" aria-label="TankScan Intelligent Textbook: Wireless Tank Monitoring Systems" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TankScan Intelligent Textbook: Wireless Tank Monitoring Systems
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              13. Predictive Maintenance and AI
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Yarmoluk/tankscan-course" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../preface/" class="md-tabs__link">
        
  
  
    
  
  Preface

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../course-description/" class="md-tabs__link">
        
  
  
    
  
  Course Description

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../01-introduction/" class="md-tabs__link">
          
  
  
  Chapters

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../learning-graph/" class="md-tabs__link">
        
  
  
    
  
  Learning Graph

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TankScan Intelligent Textbook: Wireless Tank Monitoring Systems" class="md-nav__button md-logo" aria-label="TankScan Intelligent Textbook: Wireless Tank Monitoring Systems" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TankScan Intelligent Textbook: Wireless Tank Monitoring Systems
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Yarmoluk/tankscan-course" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preface
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course-description/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Course Description
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Introduction to Tank Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-wireless-sensors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Wireless Sensor Technologies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-measurement-tech/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Radar and Ultrasonic Measurement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-iot-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. IoT Architecture and Connectivity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-aip-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. The Asset Intelligence Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-tank-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Tank Types and Applications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-industry-solutions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Industry Solutions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Installation and Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-data-analytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Data Analytics and Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-fleet-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Fleet Management and Routing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-safety-compliance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Safety, Compliance, and Hazardous Environments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-cloud-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Cloud Integration and APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    13. Predictive Maintenance and AI
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Predictive Maintenance and AI
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learning Objectives
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#131-introduction-to-ai-in-industrial-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.1 Introduction to AI in Industrial Monitoring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.1 Introduction to AI in Industrial Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-ai-value-ladder" class="md-nav__link">
    <span class="md-ellipsis">
      
        The AI Value Ladder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-ai-matters-for-tank-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why AI Matters for Tank Monitoring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#132-machine-learning-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2 Machine Learning Fundamentals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.2 Machine Learning Fundamentals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supervised-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Supervised Learning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unsupervised-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unsupervised Learning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reinforcement-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reinforcement Learning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#133-anomaly-detection-algorithms-for-tank-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.3 Anomaly Detection Algorithms for Tank Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.3 Anomaly Detection Algorithms for Tank Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-anomalies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Types of Anomalies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistical-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Statistical Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Machine Learning Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#134-predictive-maintenance-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.4 Predictive Maintenance Concepts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.4 Predictive Maintenance Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maintenance-strategy-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maintenance Strategy Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-comparison-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cost Comparison Model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#135-predicting-sensor-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.5 Predicting Sensor Failures
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.5 Predicting Sensor Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#failure-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Failure Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-sensor-failure-prediction-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building a Sensor Failure Prediction Model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#136-predicting-delivery-needs" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.6 Predicting Delivery Needs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.6 Predicting Delivery Needs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delivery-prediction-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delivery Prediction Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-days-to-empty-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simple Days-to-Empty Calculation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-forecasting-with-weighted-moving-average" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Forecasting with Weighted Moving Average
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-series-forecasting-with-facebook-prophet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Series Forecasting with Facebook Prophet
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#137-demand-forecasting-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.7 Demand Forecasting Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.7 Demand Forecasting Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-series-decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Series Decomposition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regression-based-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Regression-Based Forecasting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lstm-neural-networks-for-time-series" class="md-nav__link">
    <span class="md-ellipsis">
      
        LSTM Neural Networks for Time Series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forecast-accuracy-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forecast Accuracy Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#138-digital-twin-technology-for-tanks" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.8 Digital Twin Technology for Tanks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.8 Digital Twin Technology for Tanks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digital-twin-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Digital Twin Architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digital-twin-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Digital Twin Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-if-simulation-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        What-If Simulation Examples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#139-edge-ai-processing-on-gateway-devices" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.9 Edge AI Processing on Gateway Devices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.9 Edge AI Processing on Gateway Devices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloud-ai-vs-edge-ai" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cloud AI vs. Edge AI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edge-ai-use-cases-for-tankscan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Edge AI Use Cases for TankScan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tinyml-for-gateway-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        TinyML for Gateway Deployment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1310-natural-language-interfaces-for-tank-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.10 Natural Language Interfaces for Tank Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.10 Natural Language Interfaces for Tank Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conversational-tank-data-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conversational Tank Data Queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-of-an-nlp-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture of an NLP Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm-powered-analytics-assistant" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLM-Powered Analytics Assistant
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1311-computer-vision-for-tank-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.11 Computer Vision for Tank Inspection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.11 Computer Vision for Tank Inspection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#computer-vision-applications" class="md-nav__link">
    <span class="md-ellipsis">
      
        Computer Vision Applications
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thermal-imaging-for-leak-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Thermal Imaging for Leak Detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1312-tankscan-python-analytics-capability" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.12 TankScan Python Analytics Capability
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.12 TankScan Python Analytics Capability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analytics-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analytics Environment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-built-analytics-templates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pre-Built Analytics Templates
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1313-building-ml-models-on-tank-level-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.13 Building ML Models on Tank Level Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.13 Building ML Models on Tank Level Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-to-end-ml-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        End-to-End ML Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Implementation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1314-future-ai-roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.14 Future AI Roadmap
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.14 Future AI Roadmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#near-term-1-2-years" class="md-nav__link">
    <span class="md-ellipsis">
      
        Near-Term (1-2 Years)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medium-term-3-5-years" class="md-nav__link">
    <span class="md-ellipsis">
      
        Medium-Term (3-5 Years)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#long-term-5-10-years" class="md-nav__link">
    <span class="md-ellipsis">
      
        Long-Term (5-10 Years)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-13-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 13 Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-questions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Review Questions
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14-case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Case Studies and ROI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-future/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Future of Tank Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Graph
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learning Objectives
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#131-introduction-to-ai-in-industrial-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.1 Introduction to AI in Industrial Monitoring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.1 Introduction to AI in Industrial Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-ai-value-ladder" class="md-nav__link">
    <span class="md-ellipsis">
      
        The AI Value Ladder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-ai-matters-for-tank-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why AI Matters for Tank Monitoring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#132-machine-learning-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2 Machine Learning Fundamentals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.2 Machine Learning Fundamentals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supervised-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Supervised Learning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unsupervised-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unsupervised Learning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reinforcement-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reinforcement Learning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#133-anomaly-detection-algorithms-for-tank-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.3 Anomaly Detection Algorithms for Tank Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.3 Anomaly Detection Algorithms for Tank Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-anomalies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Types of Anomalies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistical-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Statistical Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Machine Learning Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#134-predictive-maintenance-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.4 Predictive Maintenance Concepts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.4 Predictive Maintenance Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maintenance-strategy-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maintenance Strategy Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-comparison-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cost Comparison Model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#135-predicting-sensor-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.5 Predicting Sensor Failures
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.5 Predicting Sensor Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#failure-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Failure Indicators
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-sensor-failure-prediction-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building a Sensor Failure Prediction Model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#136-predicting-delivery-needs" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.6 Predicting Delivery Needs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.6 Predicting Delivery Needs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delivery-prediction-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delivery Prediction Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-days-to-empty-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simple Days-to-Empty Calculation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-forecasting-with-weighted-moving-average" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Forecasting with Weighted Moving Average
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-series-forecasting-with-facebook-prophet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Series Forecasting with Facebook Prophet
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#137-demand-forecasting-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.7 Demand Forecasting Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.7 Demand Forecasting Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-series-decomposition" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Series Decomposition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regression-based-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Regression-Based Forecasting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lstm-neural-networks-for-time-series" class="md-nav__link">
    <span class="md-ellipsis">
      
        LSTM Neural Networks for Time Series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forecast-accuracy-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forecast Accuracy Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#138-digital-twin-technology-for-tanks" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.8 Digital Twin Technology for Tanks
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.8 Digital Twin Technology for Tanks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#digital-twin-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Digital Twin Architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digital-twin-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Digital Twin Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-if-simulation-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        What-If Simulation Examples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#139-edge-ai-processing-on-gateway-devices" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.9 Edge AI Processing on Gateway Devices
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.9 Edge AI Processing on Gateway Devices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloud-ai-vs-edge-ai" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cloud AI vs. Edge AI
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edge-ai-use-cases-for-tankscan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Edge AI Use Cases for TankScan
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tinyml-for-gateway-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      
        TinyML for Gateway Deployment
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1310-natural-language-interfaces-for-tank-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.10 Natural Language Interfaces for Tank Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.10 Natural Language Interfaces for Tank Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conversational-tank-data-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conversational Tank Data Queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-of-an-nlp-interface" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture of an NLP Interface
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llm-powered-analytics-assistant" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLM-Powered Analytics Assistant
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1311-computer-vision-for-tank-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.11 Computer Vision for Tank Inspection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.11 Computer Vision for Tank Inspection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#computer-vision-applications" class="md-nav__link">
    <span class="md-ellipsis">
      
        Computer Vision Applications
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thermal-imaging-for-leak-detection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Thermal Imaging for Leak Detection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1312-tankscan-python-analytics-capability" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.12 TankScan Python Analytics Capability
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.12 TankScan Python Analytics Capability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analytics-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Analytics Environment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-built-analytics-templates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pre-Built Analytics Templates
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1313-building-ml-models-on-tank-level-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.13 Building ML Models on Tank Level Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.13 Building ML Models on Tank Level Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-to-end-ml-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        End-to-End ML Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Implementation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1314-future-ai-roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.14 Future AI Roadmap
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.14 Future AI Roadmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#near-term-1-2-years" class="md-nav__link">
    <span class="md-ellipsis">
      
        Near-Term (1-2 Years)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#medium-term-3-5-years" class="md-nav__link">
    <span class="md-ellipsis">
      
        Medium-Term (3-5 Years)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#long-term-5-10-years" class="md-nav__link">
    <span class="md-ellipsis">
      
        Long-Term (5-10 Years)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-13-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 13 Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-questions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Review Questions
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="chapter-13-predictive-maintenance-and-ai">Chapter 13: Predictive Maintenance and AI</h1>
<h2 id="learning-objectives">Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Explain the role of artificial intelligence in industrial tank monitoring</li>
<li>Differentiate between supervised, unsupervised, and reinforcement learning approaches</li>
<li>Apply anomaly detection algorithms to identify unusual tank behavior</li>
<li>Compare predictive, preventive, and reactive maintenance strategies</li>
<li>Design demand forecasting models using time-series analysis</li>
<li>Describe digital twin technology and its application to tank monitoring</li>
<li>Evaluate edge AI processing capabilities for gateway devices</li>
<li>Build basic machine learning models on tank level data using Python</li>
<li>Assess emerging AI capabilities including NLP interfaces and computer vision</li>
</ul>
<hr />
<h2 id="131-introduction-to-ai-in-industrial-monitoring">13.1 Introduction to AI in Industrial Monitoring</h2>
<p>Artificial intelligence is transforming industrial monitoring from a passive data collection activity into an active, predictive, and prescriptive system. In the context of tank monitoring, AI enables systems to move beyond simply answering "what is the current level?" to answering far more valuable questions.</p>
<h3 id="the-ai-value-ladder">The AI Value Ladder</h3>
<pre class="mermaid"><code>graph BT
    A["Descriptive&lt;br/&gt;'What happened?'&lt;br/&gt;Historical reports"] --&gt; B["Diagnostic&lt;br/&gt;'Why did it happen?'&lt;br/&gt;Root cause analysis"]
    B --&gt; C["Predictive&lt;br/&gt;'What will happen?'&lt;br/&gt;Forecasting models"]
    C --&gt; D["Prescriptive&lt;br/&gt;'What should we do?'&lt;br/&gt;Automated recommendations"]
    D --&gt; E["Autonomous&lt;br/&gt;'Do it automatically'&lt;br/&gt;Self-optimizing systems"]

    style A fill:#90CAF9
    style B fill:#64B5F6
    style C fill:#42A5F5
    style D fill:#2196F3,color:#fff
    style E fill:#1565C0,color:#fff</code></pre>
<table>
<thead>
<tr>
<th>Level</th>
<th>Question Answered</th>
<th>TankScan Example</th>
<th>AI Technique</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Descriptive</strong></td>
<td>What is happening now?</td>
<td>Current tank level is 34%</td>
<td>Dashboards, reports</td>
</tr>
<tr>
<td><strong>Diagnostic</strong></td>
<td>Why did it happen?</td>
<td>Level dropped 20% in 2 hours due to unexpected consumption</td>
<td>Pattern matching, correlation</td>
</tr>
<tr>
<td><strong>Predictive</strong></td>
<td>What will happen next?</td>
<td>Tank will reach 15% in 3.2 days at current consumption rate</td>
<td>Time-series forecasting</td>
</tr>
<tr>
<td><strong>Prescriptive</strong></td>
<td>What should we do?</td>
<td>Schedule delivery for Thursday morning via Route A</td>
<td>Optimization algorithms</td>
</tr>
<tr>
<td><strong>Autonomous</strong></td>
<td>Execute automatically</td>
<td>Delivery order placed and route optimized without human input</td>
<td>End-to-end ML pipeline</td>
</tr>
</tbody>
</table>
<h3 id="why-ai-matters-for-tank-monitoring">Why AI Matters for Tank Monitoring</h3>
<p>Traditional tank monitoring generates enormous volumes of time-series data. A single sensor reporting every 15 minutes produces 35,040 readings per year. A fleet of 1,000 sensors generates over 35 million readings per year. Human operators cannot possibly analyze this data manually to extract all available insights.</p>
<div class="admonition note">
<p class="admonition-title">The Data Advantage</p>
<p>TankScan's cloud platform has accumulated years of tank level data across thousands of tanks in diverse environments and applications. This historical dataset is a strategic asset for training AI models that can predict behavior, detect anomalies, and optimize operations with increasing accuracy over time.</p>
</div>
<hr />
<h2 id="132-machine-learning-fundamentals">13.2 Machine Learning Fundamentals</h2>
<p>Machine learning (ML) is a subset of AI where systems learn patterns from data rather than being explicitly programmed with rules.</p>
<h3 id="supervised-learning">Supervised Learning</h3>
<p>In supervised learning, the model learns from <strong>labeled examples</strong> -- historical data where both the input and the correct output are known.</p>
<p><strong>How it works:</strong></p>
<div class="arithmatex">\[\hat{y} = f(X; \theta)\]</div>
<p>Where:
- <span class="arithmatex">\(X\)</span> = Input features (e.g., time of day, day of week, temperature, historical levels)
- <span class="arithmatex">\(\theta\)</span> = Model parameters (learned from training data)
- <span class="arithmatex">\(\hat{y}\)</span> = Predicted output (e.g., tomorrow's tank level)</p>
<p><strong>Tank monitoring applications of supervised learning:</strong></p>
<table>
<thead>
<tr>
<th>Task</th>
<th>Input Features</th>
<th>Output (Label)</th>
<th>Algorithm Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>Demand forecasting</td>
<td>Historical levels, weather, day of week</td>
<td>Future consumption volume</td>
<td>Linear regression, LSTM, Prophet</td>
</tr>
<tr>
<td>Delivery prediction</td>
<td>Consumption rate, current level, capacity</td>
<td>Days until delivery needed</td>
<td>Gradient boosting, random forest</td>
</tr>
<tr>
<td>Anomaly classification</td>
<td>Level changes, temperature, time patterns</td>
<td>Normal vs. anomalous</td>
<td>SVM, logistic regression</td>
</tr>
<tr>
<td>Sensor failure prediction</td>
<td>Signal strength, battery, temperature, age</td>
<td>Days until failure</td>
<td>Survival analysis, random forest</td>
</tr>
</tbody>
</table>
<h3 id="unsupervised-learning">Unsupervised Learning</h3>
<p>In unsupervised learning, the model finds <strong>hidden patterns</strong> in data without labeled examples.</p>
<p><strong>Tank monitoring applications:</strong></p>
<table>
<thead>
<tr>
<th>Task</th>
<th>Technique</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Clustering</strong></td>
<td>K-means, DBSCAN</td>
<td>Group tanks with similar consumption patterns</td>
</tr>
<tr>
<td><strong>Anomaly detection</strong></td>
<td>Isolation Forest, Autoencoder</td>
<td>Identify readings that deviate from normal patterns</td>
</tr>
<tr>
<td><strong>Dimensionality reduction</strong></td>
<td>PCA, t-SNE</td>
<td>Compress multi-sensor data for visualization</td>
</tr>
<tr>
<td><strong>Pattern discovery</strong></td>
<td>Association rules</td>
<td>Find correlations between environmental conditions and consumption</td>
</tr>
</tbody>
</table>
<h3 id="reinforcement-learning">Reinforcement Learning</h3>
<p>In reinforcement learning, an agent learns optimal actions through trial and error, receiving rewards for good decisions and penalties for poor ones.</p>
<p><strong>Potential tank monitoring applications:</strong></p>
<ul>
<li><strong>Route optimization</strong> -- An RL agent learns the optimal delivery sequence across multiple tanks, adapting to changing conditions</li>
<li><strong>Inventory policy</strong> -- Learning the optimal reorder point for each tank that minimizes both delivery costs and stock-out risk</li>
<li><strong>Alert tuning</strong> -- Automatically adjusting alert thresholds to minimize false alarms while catching true anomalies</li>
</ul>
<pre class="mermaid"><code>flowchart LR
    subgraph Supervised["Supervised Learning"]
        A1[Labeled Data] --&gt; A2[Train Model]
        A2 --&gt; A3[Predict on New Data]
    end

    subgraph Unsupervised["Unsupervised Learning"]
        B1[Unlabeled Data] --&gt; B2[Find Patterns]
        B2 --&gt; B3[Cluster / Detect Anomalies]
    end

    subgraph Reinforcement["Reinforcement Learning"]
        C1[Environment] --&gt; C2[Agent Takes Action]
        C2 --&gt; C3[Receive Reward/Penalty]
        C3 --&gt; C1
    end</code></pre>
<hr />
<h2 id="133-anomaly-detection-algorithms-for-tank-data">13.3 Anomaly Detection Algorithms for Tank Data</h2>
<p>Anomaly detection is arguably the most immediately valuable AI application in tank monitoring. Detecting unusual patterns can indicate leaks, theft, sensor malfunction, or process upsets.</p>
<h3 id="types-of-anomalies">Types of Anomalies</h3>
<table>
<thead>
<tr>
<th>Anomaly Type</th>
<th>Description</th>
<th>Example</th>
<th>Significance</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Point anomaly</strong></td>
<td>A single reading far from expected</td>
<td>Level jumps from 50% to 95% in one reading</td>
<td>Possible sensor error</td>
</tr>
<tr>
<td><strong>Contextual anomaly</strong></td>
<td>Reading is unusual for its context</td>
<td>Consumption at 2 AM on a Sunday</td>
<td>Possible theft or leak</td>
</tr>
<tr>
<td><strong>Collective anomaly</strong></td>
<td>A sequence of readings is unusual together</td>
<td>Gradual decline during a period of no consumption</td>
<td>Slow leak</td>
</tr>
</tbody>
</table>
<h3 id="statistical-methods">Statistical Methods</h3>
<p><strong>Z-Score Method:</strong></p>
<p>The simplest approach -- flag readings that are more than <span class="arithmatex">\(k\)</span> standard deviations from the mean:</p>
<div class="arithmatex">\[z = \frac{x - \mu}{\sigma}\]</div>
<p>If <span class="arithmatex">\(|z| &gt; k\)</span> (typically <span class="arithmatex">\(k = 3\)</span>), the reading is flagged as anomalous.</p>
<div class="admonition warning">
<p class="admonition-title">Limitation</p>
<p>The Z-score method assumes a normal distribution and a stationary process. Tank level data is often non-stationary (levels rise during deliveries and fall during consumption), so raw Z-scores applied to level data will generate many false positives. Instead, apply Z-scores to the <strong>rate of change</strong> (first derivative) rather than the absolute level.</p>
</div>
<p><strong>Moving Average Residual Method:</strong></p>
<p>Compare each reading to a moving average and flag large residuals:</p>
<div class="arithmatex">\[r_t = x_t - \frac{1}{w}\sum_{i=t-w}^{t-1} x_i\]</div>
<p>Where <span class="arithmatex">\(w\)</span> is the window size. If <span class="arithmatex">\(|r_t| &gt; k \cdot \sigma_r\)</span>, flag as anomalous.</p>
<h3 id="machine-learning-methods">Machine Learning Methods</h3>
<p><strong>Isolation Forest:</strong></p>
<p>Isolation Forest works by randomly partitioning data. Anomalies, being rare and different, require fewer partitions to isolate:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsolationForest</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Load tank data</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tank_readings.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Engineer features</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;hour&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;day_of_week&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;level_change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;level_percent&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">df</span><span class="p">[</span><span class="s2">&quot;change_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;level_change&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">*</span> <span class="mi">3600</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1"># Select features for anomaly detection</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;level_change&quot;</span><span class="p">,</span> <span class="s2">&quot;change_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;day_of_week&quot;</span><span class="p">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># Train Isolation Forest</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">model</span> <span class="o">=</span> <span class="n">IsolationForest</span><span class="p">(</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">contamination</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>  <span class="c1"># Expected 1% anomalies</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="c1"># Predict anomalies (-1 = anomaly, 1 = normal)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;anomaly&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="n">anomalies</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;anomaly&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">anomalies</span><span class="p">)</span><span class="si">}</span><span class="s2"> anomalous readings out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Autoencoder Neural Network:</strong></p>
<p>An autoencoder learns to compress and reconstruct normal data. Anomalies produce high reconstruction error:</p>
<pre class="mermaid"><code>flowchart LR
    A[Input&lt;br/&gt;Level, Rate,&lt;br/&gt;Temp, Hour] --&gt; B[Encoder&lt;br/&gt;Compress to&lt;br/&gt;latent space]
    B --&gt; C[Latent&lt;br/&gt;Representation&lt;br/&gt;2-3 dimensions]
    C --&gt; D[Decoder&lt;br/&gt;Reconstruct&lt;br/&gt;original]
    D --&gt; E[Output&lt;br/&gt;Reconstructed&lt;br/&gt;data]

    A --&gt; F[Compare]
    E --&gt; F
    F --&gt; G{Reconstruction&lt;br/&gt;Error &gt; Threshold?}
    G --&gt;|Yes| H[ANOMALY]
    G --&gt;|No| I[Normal]

    style H fill:#ff4444,color:#fff
    style I fill:#44cc44,color:#fff</code></pre>
<div class="arithmatex">\[\text{Reconstruction Error} = \|x - \hat{x}\|^2 = \sum_{i=1}^{n}(x_i - \hat{x}_i)^2\]</div>
<p>If the reconstruction error exceeds a threshold (e.g., 95th percentile of training errors), the reading is classified as anomalous.</p>
<hr />
<h2 id="134-predictive-maintenance-concepts">13.4 Predictive Maintenance Concepts</h2>
<p>Maintenance strategy has a profound impact on the reliability and cost of tank monitoring systems. AI enables a shift from reactive and preventive approaches to truly predictive maintenance.</p>
<h3 id="maintenance-strategy-comparison">Maintenance Strategy Comparison</h3>
<table>
<thead>
<tr>
<th>Strategy</th>
<th>Description</th>
<th>When Action Taken</th>
<th>Cost Profile</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Reactive</strong></td>
<td>Fix it when it breaks</td>
<td>After failure</td>
<td>Low maintenance cost, HIGH failure cost</td>
</tr>
<tr>
<td><strong>Preventive</strong></td>
<td>Service on a fixed schedule</td>
<td>Calendar or usage-based</td>
<td>Moderate cost, some unnecessary service</td>
</tr>
<tr>
<td><strong>Predictive (PdM)</strong></td>
<td>Service when data indicates impending failure</td>
<td>Before failure, based on condition</td>
<td>Optimal cost, minimal unnecessary service</td>
</tr>
<tr>
<td><strong>Prescriptive</strong></td>
<td>AI recommends specific action and timing</td>
<td>When and what to do, optimized</td>
<td>Lowest total cost</td>
</tr>
</tbody>
</table>
<pre class="mermaid"><code>graph LR
    subgraph Reactive["Reactive Maintenance"]
        R1[Sensor works] --&gt; R2[Sensor fails]
        R2 --&gt; R3[Discover failure&lt;br/&gt;days/weeks later]
        R3 --&gt; R4[Emergency dispatch]
        R4 --&gt; R5[Replace sensor]
    end

    subgraph Predictive["Predictive Maintenance"]
        P1[Sensor works] --&gt; P2[AI detects&lt;br/&gt;degradation trend]
        P2 --&gt; P3[Schedule replacement&lt;br/&gt;on next routine visit]
        P3 --&gt; P4[Replace before failure]
    end

    style Reactive fill:#ffcccc,stroke:#cc0000
    style Predictive fill:#ccffcc,stroke:#00cc00</code></pre>
<h3 id="cost-comparison-model">Cost Comparison Model</h3>
<p>The total cost of each maintenance strategy can be modeled:</p>
<p><strong>Reactive maintenance cost per sensor per year:</strong></p>
<div class="arithmatex">\[C_{reactive} = P_{failure} \times (C_{emergency\_dispatch} + C_{downtime} + C_{replacement})\]</div>
<p><strong>Preventive maintenance cost per sensor per year:</strong></p>
<div class="arithmatex">\[C_{preventive} = \frac{C_{scheduled\_visit} + C_{replacement}}{T_{replacement\_interval}} + P_{residual\_failure} \times C_{emergency\_dispatch}\]</div>
<p><strong>Predictive maintenance cost per sensor per year:</strong></p>
<div class="arithmatex">\[C_{predictive} = C_{monitoring} + C_{analytics} + P_{predicted\_failure} \times C_{planned\_replacement}\]</div>
<div class="admonition example">
<p class="admonition-title">Cost Comparison Example</p>
<p>For a fleet of 500 sensors:</p>
<table>
<thead>
<tr>
<th>Cost Component</th>
<th>Reactive</th>
<th>Preventive</th>
<th>Predictive</th>
</tr>
</thead>
<tbody>
<tr>
<td>Emergency dispatches/year</td>
<td>75 at $350 each</td>
<td>15 at $350 each</td>
<td>5 at $350 each</td>
</tr>
<tr>
<td>Scheduled replacements/year</td>
<td>0</td>
<td>100 at $200 each</td>
<td>70 at $200 each</td>
</tr>
<tr>
<td>Monitoring/analytics</td>
<td>$0</td>
<td>$0</td>
<td>$5,000</td>
</tr>
<tr>
<td>Downtime cost</td>
<td>$50,000</td>
<td>$10,000</td>
<td>$2,000</td>
</tr>
<tr>
<td><strong>Total annual cost</strong></td>
<td><strong>$76,250</strong></td>
<td><strong>$35,250</strong></td>
<td><strong>$22,750</strong></td>
</tr>
<tr>
<td><strong>Savings vs. reactive</strong></td>
<td>--</td>
<td><strong>54%</strong></td>
<td><strong>70%</strong></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h2 id="135-predicting-sensor-failures">13.5 Predicting Sensor Failures</h2>
<p>Wireless tank sensors are remote, battery-powered devices in harsh environments. Predicting failures before they occur is critical for maintaining data continuity.</p>
<h3 id="failure-indicators">Failure Indicators</h3>
<table>
<thead>
<tr>
<th>Indicator</th>
<th>Data Source</th>
<th>Warning Sign</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Battery voltage</strong></td>
<td>Sensor telemetry</td>
<td>Accelerating voltage decline</td>
</tr>
<tr>
<td><strong>Signal strength (RSSI)</strong></td>
<td>Sensor telemetry</td>
<td>Degrading over time</td>
</tr>
<tr>
<td><strong>Reading frequency</strong></td>
<td>Platform data</td>
<td>Missed or delayed readings</td>
</tr>
<tr>
<td><strong>Temperature extremes</strong></td>
<td>Sensor telemetry</td>
<td>Prolonged exposure outside rated range</td>
</tr>
<tr>
<td><strong>Reading variance</strong></td>
<td>Platform data</td>
<td>Increasing noise in measurements</td>
</tr>
<tr>
<td><strong>Sensor age</strong></td>
<td>Asset management</td>
<td>Approaching end of rated life</td>
</tr>
</tbody>
</table>
<h3 id="building-a-sensor-failure-prediction-model">Building a Sensor Failure Prediction Model</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1"># Load sensor telemetry data</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1"># Each row = one sensor&#39;s monthly summary</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;sensor_health.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1"># Feature engineering</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">features</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="s2">&quot;battery_voltage_mean&quot;</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="s2">&quot;battery_voltage_slope&quot;</span><span class="p">,</span>       <span class="c1"># Rate of voltage decline</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="s2">&quot;rssi_mean&quot;</span><span class="p">,</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="s2">&quot;rssi_std&quot;</span><span class="p">,</span>                    <span class="c1"># Signal stability</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="s2">&quot;missed_readings_count&quot;</span><span class="p">,</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="s2">&quot;reading_variance&quot;</span><span class="p">,</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="s2">&quot;temperature_max&quot;</span><span class="p">,</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="s2">&quot;temperature_min&quot;</span><span class="p">,</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="s2">&quot;sensor_age_months&quot;</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    <span class="s2">&quot;readings_per_day_mean&quot;</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="p">]</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="c1"># Target: did the sensor fail within the next 30 days?</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;failed_within_30_days&quot;</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="c1"># Split data</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="p">)</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="c1"># Train model</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>    <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="p">)</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="c1"># Evaluate</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="c1"># Feature importance</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="n">importance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>    <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>    <span class="n">index</span><span class="o">=</span><span class="n">features</span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Feature Importance:&quot;</span><span class="p">)</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="nb">print</span><span class="p">(</span><span class="n">importance</span><span class="p">)</span>
</code></pre></div>
<p><strong>Typical feature importance ranking:</strong></p>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Feature</th>
<th>Importance</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Battery voltage slope</td>
<td>0.28</td>
</tr>
<tr>
<td>2</td>
<td>Missed readings count</td>
<td>0.22</td>
</tr>
<tr>
<td>3</td>
<td>Sensor age (months)</td>
<td>0.15</td>
</tr>
<tr>
<td>4</td>
<td>Battery voltage mean</td>
<td>0.12</td>
</tr>
<tr>
<td>5</td>
<td>Reading variance</td>
<td>0.09</td>
</tr>
<tr>
<td>6</td>
<td>RSSI mean</td>
<td>0.07</td>
</tr>
<tr>
<td>7</td>
<td>Temperature extremes</td>
<td>0.04</td>
</tr>
<tr>
<td>8</td>
<td>Other features</td>
<td>0.03</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Actionable Predictions</p>
<p>A prediction model is only valuable if it drives action. For each sensor predicted to fail within 30 days, the system should automatically:</p>
<ol>
<li>Create a work order in the maintenance management system</li>
<li>Assign the replacement to the next scheduled visit to that area</li>
<li>Ensure a replacement sensor is in the technician's inventory</li>
<li>Alert the account manager so the customer is informed proactively</li>
</ol>
</div>
<hr />
<h2 id="136-predicting-delivery-needs">13.6 Predicting Delivery Needs</h2>
<p>For distributors, predicting when each tank will need a delivery is the foundation of route optimization and customer service excellence.</p>
<h3 id="delivery-prediction-pipeline">Delivery Prediction Pipeline</h3>
<pre class="mermaid"><code>flowchart TD
    A[Historical Level Data] --&gt; B[Feature Engineering]
    B --&gt; C[Consumption Rate&lt;br/&gt;Estimation]
    C --&gt; D[Days-to-Empty&lt;br/&gt;Prediction]
    D --&gt; E[Delivery Window&lt;br/&gt;Calculation]
    E --&gt; F[Route Optimization&lt;br/&gt;Input]

    G[External Data] --&gt; B
    G --&gt; G1[Weather forecast]
    G --&gt; G2[Day of week / holidays]
    G --&gt; G3[Seasonal patterns]
    G --&gt; G4[Customer schedule]

    style A fill:#2196F3,color:#fff
    style F fill:#4CAF50,color:#fff</code></pre>
<h3 id="simple-days-to-empty-calculation">Simple Days-to-Empty Calculation</h3>
<p>The most basic prediction uses the average consumption rate:</p>
<div class="arithmatex">\[\text{Days to Empty} = \frac{V_{current} - V_{reorder}}{R_{avg}}\]</div>
<p>Where:
- <span class="arithmatex">\(V_{current}\)</span> = Current volume in the tank
- <span class="arithmatex">\(V_{reorder}\)</span> = Volume at which reorder should be triggered
- <span class="arithmatex">\(R_{avg}\)</span> = Average daily consumption rate</p>
<div class="admonition warning">
<p class="admonition-title">Limitation of Simple Average</p>
<p>Using a simple average consumption rate ignores seasonality, day-of-week effects, and trends. A propane tank that averages 5 gallons/day across the year might consume 12 gallons/day in January and 1 gallon/day in July. The simple average would drastically underpredict winter delivery needs and overpredict summer needs.</p>
</div>
<h3 id="advanced-forecasting-with-weighted-moving-average">Advanced Forecasting with Weighted Moving Average</h3>
<p>A better approach weights recent data more heavily:</p>
<div class="arithmatex">\[R_{weighted} = \frac{\sum_{i=1}^{n} w_i \cdot r_i}{\sum_{i=1}^{n} w_i}\]</div>
<p>Where <span class="arithmatex">\(w_i = \alpha^{n-i}\)</span> is an exponential decay weight with <span class="arithmatex">\(0 &lt; \alpha &lt; 1\)</span>.</p>
<h3 id="time-series-forecasting-with-facebook-prophet">Time Series Forecasting with Facebook Prophet</h3>
<p>For tanks with complex seasonal patterns, Facebook Prophet provides excellent forecasting:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">prophet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prophet</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Prepare data in Prophet format</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">df_prophet</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="s1">&#39;ds&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>      <span class="c1"># Date column</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;volume_gallons&#39;</span><span class="p">]</span>   <span class="c1"># Value to forecast</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">})</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># Create and configure model</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    <span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Flexibility for trend changes</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="n">seasonality_mode</span><span class="o">=</span><span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    <span class="n">yearly_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="n">weekly_seasonality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="n">daily_seasonality</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Tank readings typically too sparse for daily patterns</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="p">)</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c1"># Add weather as external regressor if available</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="k">if</span> <span class="s1">&#39;temperature_avg&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>    <span class="n">df_prophet</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;temperature_avg&#39;</span><span class="p">]</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>    <span class="n">model</span><span class="o">.</span><span class="n">add_regressor</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="c1"># Fit model</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_prophet</span><span class="p">)</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="c1"># Forecast 30 days ahead</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="n">future</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="k">if</span> <span class="s1">&#39;temperature&#39;</span> <span class="ow">in</span> <span class="n">df_prophet</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>    <span class="c1"># Add forecasted temperature (from weather API)</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>    <span class="n">future</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_weather_forecast</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="n">forecast</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="c1"># Find the date when level crosses reorder threshold</span>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="n">reorder_volume</span> <span class="o">=</span> <span class="mi">500</span>  <span class="c1"># gallons</span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="n">delivery_date</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">[</span><span class="n">forecast</span><span class="p">[</span><span class="s1">&#39;yhat&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">reorder_volume</span><span class="p">][</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted delivery needed by: </span><span class="si">{</span><span class="n">delivery_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="137-demand-forecasting-models">13.7 Demand Forecasting Models</h2>
<p>Beyond individual tank delivery prediction, AI enables demand forecasting at the fleet level -- predicting total product demand across all monitored tanks.</p>
<h3 id="time-series-decomposition">Time Series Decomposition</h3>
<p>Tank consumption data can be decomposed into four components:</p>
<div class="arithmatex">\[y_t = T_t + S_t + C_t + \epsilon_t\]</div>
<p>Where:
- <span class="arithmatex">\(T_t\)</span> = <strong>Trend</strong> -- Long-term increase or decrease in consumption
- <span class="arithmatex">\(S_t\)</span> = <strong>Seasonality</strong> -- Recurring patterns (weekly, monthly, yearly)
- <span class="arithmatex">\(C_t\)</span> = <strong>Cyclical</strong> -- Longer-period fluctuations (economic cycles)
- <span class="arithmatex">\(\epsilon_t\)</span> = <strong>Residual</strong> -- Random variation</p>
<pre class="mermaid"><code>graph TD
    A[Raw Consumption Data] --&gt; B[Decomposition]
    B --&gt; C[Trend Component&lt;br/&gt;Long-term direction]
    B --&gt; D[Seasonal Component&lt;br/&gt;Recurring patterns]
    B --&gt; E[Cyclical Component&lt;br/&gt;Economic cycles]
    B --&gt; F[Residual&lt;br/&gt;Random noise]

    C --&gt; G[Recompose Forecast]
    D --&gt; G
    E --&gt; G
    G --&gt; H[Demand Forecast&lt;br/&gt;with Confidence Intervals]</code></pre>
<h3 id="regression-based-forecasting">Regression-Based Forecasting</h3>
<p>Multiple regression can incorporate external variables that influence consumption:</p>
<div class="arithmatex">\[\hat{y} = \beta_0 + \beta_1 x_{temp} + \beta_2 x_{day} + \beta_3 x_{season} + \beta_4 x_{price} + \epsilon\]</div>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Type</th>
<th>Influence on Consumption</th>
</tr>
</thead>
<tbody>
<tr>
<td>Temperature (<span class="arithmatex">\(x_{temp}\)</span>)</td>
<td>Continuous</td>
<td>Strong (heating fuels, HVAC)</td>
</tr>
<tr>
<td>Day of week (<span class="arithmatex">\(x_{day}\)</span>)</td>
<td>Categorical</td>
<td>Moderate (business vs. weekend)</td>
</tr>
<tr>
<td>Season (<span class="arithmatex">\(x_{season}\)</span>)</td>
<td>Categorical</td>
<td>Strong (seasonal products)</td>
</tr>
<tr>
<td>Product price (<span class="arithmatex">\(x_{price}\)</span>)</td>
<td>Continuous</td>
<td>Weak-moderate (price elasticity)</td>
</tr>
<tr>
<td>Holidays (<span class="arithmatex">\(x_{holiday}\)</span>)</td>
<td>Binary</td>
<td>Moderate (business closures)</td>
</tr>
<tr>
<td>Economic indicators (<span class="arithmatex">\(x_{econ}\)</span>)</td>
<td>Continuous</td>
<td>Weak (long-term trends)</td>
</tr>
</tbody>
</table>
<h3 id="lstm-neural-networks-for-time-series">LSTM Neural Networks for Time Series</h3>
<p>Long Short-Term Memory (LSTM) networks are a type of recurrent neural network particularly well-suited for time-series forecasting:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1"># Prepare sequences</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_sequences</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lookback</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">forecast</span><span class="p">):</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">lookback</span><span class="p">:</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">forecast</span><span class="p">])</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c1"># Normalize data</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinMaxScaler</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">consumption_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="c1"># Create sequences: use 30 days to predict next 7 days</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">create_sequences</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">forecast</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c1"># Build LSTM model</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>    <span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>    <span class="n">LSTM</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>    <span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>    <span class="n">Dense</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># Predict 7 days ahead</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="p">])</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="c1"># Forecast</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="n">last_30_days</span> <span class="o">=</span> <span class="n">scaled_data</span><span class="p">[</span><span class="o">-</span><span class="mi">30</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="n">forecast_scaled</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_30_days</span><span class="p">)</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="n">forecast</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">forecast_scaled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;7-day consumption forecast: </span><span class="si">{</span><span class="n">forecast</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="forecast-accuracy-metrics">Forecast Accuracy Metrics</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Formula</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>MAE</strong> (Mean Absolute Error)</td>
<td><span class="arithmatex">\(\frac{1}{n}\sum\|y_i - \hat{y}_i\|\)</span></td>
<td>Average absolute prediction error</td>
</tr>
<tr>
<td><strong>RMSE</strong> (Root Mean Square Error)</td>
<td><span class="arithmatex">\(\sqrt{\frac{1}{n}\sum(y_i - \hat{y}_i)^2}\)</span></td>
<td>Penalizes large errors more</td>
</tr>
<tr>
<td><strong>MAPE</strong> (Mean Absolute % Error)</td>
<td><span class="arithmatex">\(\frac{100}{n}\sum\left\|\frac{y_i - \hat{y}_i}{y_i}\right\|\)</span></td>
<td>Percentage error (scale-independent)</td>
</tr>
<tr>
<td><strong>R-squared</strong> (<span class="arithmatex">\(R^2\)</span>)</td>
<td><span class="arithmatex">\(1 - \frac{\sum(y_i - \hat{y}_i)^2}{\sum(y_i - \bar{y})^2}\)</span></td>
<td>Proportion of variance explained</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Acceptable Accuracy</p>
<p>For tank delivery prediction, a MAPE of 10-15% is typically acceptable for 7-day forecasts. For 30-day forecasts, 15-25% MAPE is common. Accuracy improves significantly with more historical data and the inclusion of external variables like weather.</p>
</div>
<hr />
<h2 id="138-digital-twin-technology-for-tanks">13.8 Digital Twin Technology for Tanks</h2>
<p>A <strong>digital twin</strong> is a virtual replica of a physical asset that mirrors its real-time state and behavior. For tank monitoring, digital twins enable simulation, prediction, and optimization that goes beyond what sensor data alone can provide.</p>
<h3 id="digital-twin-architecture">Digital Twin Architecture</h3>
<pre class="mermaid"><code>flowchart TD
    subgraph Physical["Physical World"]
        T[Physical Tank] --&gt; S[Sensors&lt;br/&gt;Level, Temp, Pressure]
    end

    subgraph Digital["Digital Twin"]
        S --&gt;|Real-time data| DT[Tank Digital Twin Model]
        DT --&gt; SIM[Simulation Engine]
        DT --&gt; PRED[Prediction Module]
        DT --&gt; VIS[3D Visualization]

        SIM --&gt; WIF["What-If Analysis"]
        PRED --&gt; FORE["Forecast Module"]
        VIS --&gt; DASH["Operator Dashboard"]
    end

    subgraph Actions["Actions"]
        WIF --&gt; OPT[Optimization&lt;br/&gt;Recommendations]
        FORE --&gt; ALERT[Predictive&lt;br/&gt;Alerts]
        DASH --&gt; OP[Operator&lt;br/&gt;Decisions]
    end

    style Physical fill:#e8f4fd,stroke:#2196F3
    style Digital fill:#fff3e0,stroke:#FF9800
    style Actions fill:#e8f5e9,stroke:#4CAF50</code></pre>
<h3 id="digital-twin-components">Digital Twin Components</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Data Source</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Geometric model</strong></td>
<td>Tank specifications</td>
<td>Volume calculations, 3D visualization</td>
</tr>
<tr>
<td><strong>Fluid model</strong></td>
<td>Product data sheets</td>
<td>Thermal expansion, viscosity, density</td>
</tr>
<tr>
<td><strong>Thermal model</strong></td>
<td>Temperature sensors, weather data</td>
<td>Predict temperature effects on level readings</td>
</tr>
<tr>
<td><strong>Consumption model</strong></td>
<td>Historical level data</td>
<td>Forecast future consumption patterns</td>
</tr>
<tr>
<td><strong>Structural model</strong></td>
<td>Material specs, age, inspections</td>
<td>Predict corrosion and structural degradation</td>
</tr>
<tr>
<td><strong>Environmental model</strong></td>
<td>Weather API, site conditions</td>
<td>Account for external influences</td>
</tr>
</tbody>
</table>
<h3 id="what-if-simulation-examples">What-If Simulation Examples</h3>
<p>Digital twins enable "what-if" analysis without risking the physical asset:</p>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Simulation Question</th>
<th>Business Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Capacity change</td>
<td>"What if we replaced this 5,000-gal tank with 10,000-gal?"</td>
<td>Capital planning</td>
</tr>
<tr>
<td>Delivery frequency</td>
<td>"What if we delivered every 2 weeks instead of weekly?"</td>
<td>Route optimization</td>
</tr>
<tr>
<td>Temperature extreme</td>
<td>"What if ambient temp hits 110 degrees F for 3 days?"</td>
<td>Safety planning</td>
</tr>
<tr>
<td>Demand surge</td>
<td>"What if consumption doubles for 2 weeks?"</td>
<td>Emergency planning</td>
</tr>
<tr>
<td>Product switch</td>
<td>"What if we switch from Diesel #2 to biodiesel blend?"</td>
<td>Compatibility assessment</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="139-edge-ai-processing-on-gateway-devices">13.9 Edge AI Processing on Gateway Devices</h2>
<p>While cloud-based AI is powerful, some applications require intelligence at the edge -- on the gateway device itself -- to reduce latency, bandwidth, and cloud dependency.</p>
<h3 id="cloud-ai-vs-edge-ai">Cloud AI vs. Edge AI</h3>
<table>
<thead>
<tr>
<th>Characteristic</th>
<th>Cloud AI</th>
<th>Edge AI</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Processing power</strong></td>
<td>Virtually unlimited</td>
<td>Constrained (embedded processor)</td>
</tr>
<tr>
<td><strong>Latency</strong></td>
<td>Seconds to minutes (network dependent)</td>
<td>Milliseconds</td>
</tr>
<tr>
<td><strong>Bandwidth required</strong></td>
<td>All data uploaded</td>
<td>Only summaries/alerts uploaded</td>
</tr>
<tr>
<td><strong>Connectivity required</strong></td>
<td>Always (for real-time)</td>
<td>Can operate offline</td>
</tr>
<tr>
<td><strong>Model complexity</strong></td>
<td>Any (large models, ensembles)</td>
<td>Limited (small, efficient models)</td>
</tr>
<tr>
<td><strong>Update frequency</strong></td>
<td>Real-time</td>
<td>Periodic OTA updates</td>
</tr>
<tr>
<td><strong>Cost</strong></td>
<td>Cloud compute charges</td>
<td>One-time hardware cost</td>
</tr>
</tbody>
</table>
<h3 id="edge-ai-use-cases-for-tankscan">Edge AI Use Cases for TankScan</h3>
<pre class="mermaid"><code>flowchart LR
    subgraph Gateway["TankScan Gateway (Edge AI)"]
        A[Sensor Data In] --&gt; B[Local Anomaly&lt;br/&gt;Detection]
        A --&gt; C[Data Compression&lt;br/&gt;&amp; Summarization]
        A --&gt; D[Local Alerting&lt;br/&gt;No cloud needed]
        B --&gt; E[Anomaly Score]
        C --&gt; F[Compressed Data]
    end

    E --&gt;|Only anomalies| G[TankScan Cloud]
    F --&gt;|Summaries| G
    D --&gt;|Critical alerts| H[Local Alarm&lt;br/&gt;SMS/Relay]

    style Gateway fill:#fff3e0,stroke:#FF9800</code></pre>
<table>
<thead>
<tr>
<th>Edge AI Task</th>
<th>Description</th>
<th>Benefit</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Local anomaly detection</strong></td>
<td>Run lightweight anomaly detection on the gateway</td>
<td>Immediate alerts even without connectivity</td>
</tr>
<tr>
<td><strong>Data compression</strong></td>
<td>Send only significant changes, not every reading</td>
<td>Reduce cellular data costs by 70-80%</td>
</tr>
<tr>
<td><strong>Predictive alerting</strong></td>
<td>Calculate hours-to-empty locally</td>
<td>Alerts continue during cloud outages</td>
</tr>
<tr>
<td><strong>Sensor fusion</strong></td>
<td>Combine multiple sensor inputs locally</td>
<td>Reduce noise, improve accuracy</td>
</tr>
<tr>
<td><strong>Adaptive sampling</strong></td>
<td>Increase reading frequency when changes detected</td>
<td>Better resolution during critical periods</td>
</tr>
</tbody>
</table>
<h3 id="tinyml-for-gateway-deployment">TinyML for Gateway Deployment</h3>
<p><strong>TinyML</strong> refers to machine learning models optimized for microcontrollers and edge devices:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Example: Convert a trained model to TensorFlow Lite for edge deployment</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># Assume &#39;model&#39; is a trained Keras model</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">converter</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">lite</span><span class="o">.</span><span class="n">TFLiteConverter</span><span class="o">.</span><span class="n">from_keras_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1"># Optimize for size and speed</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">converter</span><span class="o">.</span><span class="n">optimizations</span> <span class="o">=</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">lite</span><span class="o">.</span><span class="n">Optimize</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">]</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">converter</span><span class="o">.</span><span class="n">target_spec</span><span class="o">.</span><span class="n">supported_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">float16</span><span class="p">]</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="c1"># Convert</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="n">tflite_model</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">convert</span><span class="p">()</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="c1"># Save for deployment to gateway</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;anomaly_detector.tflite&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tflite_model</span><span class="p">)</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tflite_model</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> KB&quot;</span><span class="p">)</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="c1"># Typical output: &quot;Model size: 12.3 KB&quot;</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Model Size Targets</p>
<p>For gateway deployment, ML models should typically be under 100 KB and require less than 256 KB of RAM during inference. This constrains model architecture but is achievable for common tank monitoring tasks using techniques like quantization, pruning, and knowledge distillation.</p>
</div>
<hr />
<h2 id="1310-natural-language-interfaces-for-tank-data">13.10 Natural Language Interfaces for Tank Data</h2>
<p>Natural Language Processing (NLP) enables non-technical users to query tank data conversationally, removing the barrier of complex dashboards and report builders.</p>
<h3 id="conversational-tank-data-queries">Conversational Tank Data Queries</h3>
<p>Instead of navigating through multiple dashboard screens, a user could simply ask:</p>
<table>
<thead>
<tr>
<th>Natural Language Query</th>
<th>System Action</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>"Which tanks need delivery this week?"</td>
<td>Query all tanks, filter by days-to-empty &lt; 7</td>
<td>"14 tanks need delivery by Friday. The most urgent is Tank 456 (Diesel) at Site 23 with 12% remaining."</td>
</tr>
<tr>
<td>"What was the consumption at Site 15 last month?"</td>
<td>Aggregate consumption data for all tanks at Site 15</td>
<td>"Site 15 consumed 12,400 gallons of diesel and 3,200 gallons of DEF in January."</td>
</tr>
<tr>
<td>"Are any sensors having issues?"</td>
<td>Check sensor health metrics across fleet</td>
<td>"3 sensors show degraded signal strength. Sensor at Tank 789 has been intermittent for 48 hours."</td>
</tr>
<tr>
<td>"Compare this winter's propane usage to last winter."</td>
<td>Year-over-year consumption analysis</td>
<td>"Propane consumption is 8% higher than last winter, likely due to 12% more heating degree days."</td>
</tr>
</tbody>
</table>
<h3 id="architecture-of-an-nlp-interface">Architecture of an NLP Interface</h3>
<pre class="mermaid"><code>flowchart TD
    A[User Query&lt;br/&gt;'Which tanks are below 20%?'] --&gt; B[NLP Engine&lt;br/&gt;Parse intent and entities]
    B --&gt; C[Intent: filter_tanks&lt;br/&gt;Entity: level &lt; 20%]
    C --&gt; D[API Query Builder&lt;br/&gt;GET /tanks?level_lt=20]
    D --&gt; E[TankScan API]
    E --&gt; F[Results&lt;br/&gt;5 tanks returned]
    F --&gt; G[Response Generator&lt;br/&gt;Natural language response]
    G --&gt; H["'5 tanks are currently below 20%.&lt;br/&gt;Tank 123 at Site A is most critical at 8%.'"]</code></pre>
<h3 id="llm-powered-analytics-assistant">LLM-Powered Analytics Assistant</h3>
<p>Modern Large Language Models (LLMs) can serve as intelligent analytics assistants:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Example: LLM-powered tank data assistant</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">openai</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenAI</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">client</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">()</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># Define available functions the LLM can call</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">tools</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="p">{</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;get_tank_level&quot;</span><span class="p">,</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Get the current level of a specific tank&quot;</span><span class="p">,</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>                    <span class="s2">&quot;tank_id&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>                    <span class="s2">&quot;tank_name&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">}</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>                <span class="p">}</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>            <span class="p">}</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        <span class="p">}</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="p">},</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="p">{</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>        <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;get_low_tanks&quot;</span><span class="p">,</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Get all tanks below a specified level percentage&quot;</span><span class="p">,</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>                <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>                    <span class="s2">&quot;threshold_percent&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>                <span class="p">}</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>            <span class="p">}</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>        <span class="p">}</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>    <span class="p">}</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="p">]</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="k">def</span><span class="w"> </span><span class="nf">chat_with_tanks</span><span class="p">(</span><span class="n">user_message</span><span class="p">):</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>        <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4&quot;</span><span class="p">,</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>        <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a>            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;You are a helpful tank monitoring assistant.&quot;</span><span class="p">},</span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>            <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">user_message</span><span class="p">}</span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>        <span class="p">],</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>        <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>        <span class="n">tool_choice</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>    <span class="p">)</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>    <span class="c1"># Process tool calls and generate response</span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>    <span class="k">return</span> <span class="n">response</span>
</code></pre></div>
<hr />
<h2 id="1311-computer-vision-for-tank-inspection">13.11 Computer Vision for Tank Inspection</h2>
<p>Computer vision -- AI that interprets images and video -- opens new possibilities for tank inspection that complement level monitoring data.</p>
<h3 id="computer-vision-applications">Computer Vision Applications</h3>
<table>
<thead>
<tr>
<th>Application</th>
<th>Input</th>
<th>Output</th>
<th>Benefit</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Corrosion detection</strong></td>
<td>Tank exterior photos</td>
<td>Corrosion severity map</td>
<td>Early structural issue identification</td>
</tr>
<tr>
<td><strong>Leak visualization</strong></td>
<td>Thermal camera images</td>
<td>Leak location highlighted</td>
<td>Pinpoint leak sources on large tanks</td>
</tr>
<tr>
<td><strong>Label/marking reading</strong></td>
<td>Photos of tank labels</td>
<td>Extracted text (tank ID, capacity, product)</td>
<td>Automated asset inventory</td>
</tr>
<tr>
<td><strong>Containment area inspection</strong></td>
<td>Drone photos</td>
<td>Deficiency annotations</td>
<td>Efficient compliance auditing</td>
</tr>
<tr>
<td><strong>Delivery verification</strong></td>
<td>Camera at fill port</td>
<td>Delivery start/stop timestamps</td>
<td>Automated delivery documentation</td>
</tr>
</tbody>
</table>
<h3 id="thermal-imaging-for-leak-detection">Thermal Imaging for Leak Detection</h3>
<p>Thermal cameras can detect leaks by identifying temperature differences where liquid contacts tank surfaces:</p>
<pre class="mermaid"><code>graph TD
    A[Thermal Camera&lt;br/&gt;Captures IR image] --&gt; B[Image Processing&lt;br/&gt;Temperature mapping]
    B --&gt; C[Anomaly Detection&lt;br/&gt;Compare to expected pattern]
    C --&gt; D{Temperature&lt;br/&gt;anomaly found?}
    D --&gt;|Yes| E[Classify anomaly&lt;br/&gt;Leak vs. other cause]
    D --&gt;|No| F[Tank healthy]
    E --&gt; G{Likely leak?}
    G --&gt;|Yes| H[Generate alert with&lt;br/&gt;location and severity]
    G --&gt;|No| I[Log as non-leak&lt;br/&gt;anomaly]</code></pre>
<div class="admonition note">
<p class="admonition-title">Complementary to Level Monitoring</p>
<p>Computer vision does not replace level monitoring -- it complements it. Level monitoring detects that a leak exists (unexplained level drop); computer vision helps locate where the leak is. Together, they provide both detection and diagnosis.</p>
</div>
<hr />
<h2 id="1312-tankscan-python-analytics-capability">13.12 TankScan Python Analytics Capability</h2>
<p>TankScan's platform includes Python-based analytics capabilities for customers who want to build custom models on their tank data.</p>
<h3 id="analytics-environment">Analytics Environment</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># TankScan Python Analytics - Example Workflow</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">tankscan.analytics</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tsa</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1"># Connect to your TankScan data</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">session</span> <span class="o">=</span> <span class="n">tsa</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;YOUR_KEY&quot;</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c1"># Load data for analysis</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">tanks</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_tanks</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;Northeast Region&quot;</span><span class="p">)</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">data</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_readings</span><span class="p">(</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>    <span class="n">tanks</span><span class="o">=</span><span class="n">tanks</span><span class="p">,</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2025-01-01&quot;</span><span class="p">,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="p">)</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="c1"># Built-in analytics functions</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c1"># 1. Consumption analysis</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="n">consumption</span> <span class="o">=</span> <span class="n">tsa</span><span class="o">.</span><span class="n">analyze_consumption</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">consumption</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="c1"># 2. Seasonal decomposition</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="n">decomposition</span> <span class="o">=</span> <span class="n">tsa</span><span class="o">.</span><span class="n">decompose</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s2">&quot;yearly&quot;</span><span class="p">)</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="n">decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="c1"># 3. Anomaly detection</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="n">anomalies</span> <span class="o">=</span> <span class="n">tsa</span><span class="o">.</span><span class="n">detect_anomalies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;isolation_forest&quot;</span><span class="p">)</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">anomalies</span><span class="p">)</span><span class="si">}</span><span class="s2"> anomalous readings&quot;</span><span class="p">)</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="c1"># 4. Delivery prediction</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">tsa</span><span class="o">.</span><span class="n">predict_deliveries</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">horizon_days</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="k">for</span> <span class="n">tank_id</span><span class="p">,</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tank </span><span class="si">{</span><span class="n">tank_id</span><span class="si">}</span><span class="s2">: delivery needed by </span><span class="si">{</span><span class="n">pred</span><span class="o">.</span><span class="n">date</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>          <span class="sa">f</span><span class="s2">&quot;(confidence: </span><span class="si">{</span><span class="n">pred</span><span class="o">.</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.0%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="c1"># 5. Export results</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="n">predictions</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;delivery_forecast.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="n">predictions</span><span class="o">.</span><span class="n">to_dashboard</span><span class="p">(</span><span class="s2">&quot;Delivery Forecast Dashboard&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="pre-built-analytics-templates">Pre-Built Analytics Templates</h3>
<table>
<thead>
<tr>
<th>Template</th>
<th>Description</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Consumption Report</strong></td>
<td>Monthly/weekly consumption by tank, group, or product</td>
<td>PDF report + CSV data</td>
</tr>
<tr>
<td><strong>Delivery Optimizer</strong></td>
<td>Optimal delivery schedule for next N days</td>
<td>Route plan + delivery volumes</td>
</tr>
<tr>
<td><strong>Anomaly Report</strong></td>
<td>All detected anomalies with severity scores</td>
<td>Alert list + visualizations</td>
</tr>
<tr>
<td><strong>Sensor Health</strong></td>
<td>Fleet-wide sensor health assessment</td>
<td>Maintenance priority list</td>
</tr>
<tr>
<td><strong>Seasonal Forecast</strong></td>
<td>Next-season demand forecast by product and region</td>
<td>Forecast charts + data</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="1313-building-ml-models-on-tank-level-data">13.13 Building ML Models on Tank Level Data</h2>
<p>This section provides a practical, end-to-end guide to building a machine learning model for tank delivery prediction.</p>
<h3 id="end-to-end-ml-pipeline">End-to-End ML Pipeline</h3>
<pre class="mermaid"><code>flowchart LR
    A[1. Data&lt;br/&gt;Collection] --&gt; B[2. Feature&lt;br/&gt;Engineering]
    B --&gt; C[3. Model&lt;br/&gt;Selection]
    C --&gt; D[4. Training &amp;&lt;br/&gt;Validation]
    D --&gt; E[5. Evaluation]
    E --&gt; F[6. Deployment]
    F --&gt; G[7. Monitoring &amp;&lt;br/&gt;Retraining]
    G --&gt; A</code></pre>
<h3 id="step-by-step-implementation">Step-by-Step Implementation</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="sd">Complete ML Pipeline: Predict days until delivery needed</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="c1"># STEP 1: Data Collection</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="c1"># Load historical tank data with delivery events</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="n">readings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tank_readings.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="n">deliveries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;delivery_events.csv&quot;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;delivery_date&quot;</span><span class="p">])</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="c1"># STEP 2: Feature Engineering</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">engineer_features</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create predictive features from raw tank readings.&quot;&quot;&quot;</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>    <span class="n">features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>    <span class="c1"># Current state</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;current_level_pct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;level_percent&quot;</span><span class="p">]</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;current_volume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;volume_gallons&quot;</span><span class="p">]</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>    <span class="c1"># Consumption rates (multiple windows)</span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;consumption_rate_7d&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;volume_gallons&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="mi">24</span><span class="p">)</span> <span class="o">/</span> <span class="mi">7</span>  <span class="c1"># 7-day avg daily consumption</span>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>    <span class="p">)</span>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;consumption_rate_30d&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;volume_gallons&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="o">*</span><span class="mi">24</span><span class="p">)</span> <span class="o">/</span> <span class="mi">30</span>  <span class="c1"># 30-day avg daily consumption</span>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>    <span class="p">)</span>
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>
<a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>    <span class="c1"># Consumption acceleration</span>
<a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;consumption_acceleration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;consumption_rate_7d&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">features</span><span class="p">[</span><span class="s2">&quot;consumption_rate_30d&quot;</span><span class="p">]</span>
<a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>    <span class="p">)</span>
<a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>
<a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>    <span class="c1"># Temporal features</span>
<a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;day_of_week&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span>
<a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;is_weekend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofweek</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>
<a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>    <span class="c1"># Environmental</span>
<a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>    <span class="k">if</span> <span class="s2">&quot;temperature_f&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature_f&quot;</span><span class="p">]</span>
<a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;heating_degree_days&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">65</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;temperature_f&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a>
<a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>    <span class="c1"># Tank characteristics</span>
<a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;tank_capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;tank_capacity&quot;</span><span class="p">]</span>
<a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>    <span class="n">features</span><span class="p">[</span><span class="s2">&quot;fill_ratio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;volume_gallons&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;tank_capacity&quot;</span><span class="p">]</span>
<a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>
<a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>    <span class="k">return</span> <span class="n">features</span>
<a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>
<a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a><span class="n">features</span> <span class="o">=</span> <span class="n">engineer_features</span><span class="p">(</span><span class="n">readings</span><span class="p">)</span>
<a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>
<a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a><span class="c1"># STEP 3: Create Target Variable</span>
<a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a><span class="c1"># For each reading, calculate how many days until the next delivery</span>
<a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a><span class="c1"># (This requires joining with delivery events)</span>
<a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_days_to_delivery</span><span class="p">(</span><span class="n">readings_df</span><span class="p">,</span> <span class="n">deliveries_df</span><span class="p">):</span>
<a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate days until next delivery for each reading.&quot;&quot;&quot;</span>
<a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>    <span class="n">days_to_delivery</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">reading</span> <span class="ow">in</span> <span class="n">readings_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a>        <span class="n">future_deliveries</span> <span class="o">=</span> <span class="n">deliveries_df</span><span class="p">[</span>
<a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a>            <span class="p">(</span><span class="n">deliveries_df</span><span class="p">[</span><span class="s2">&quot;tank_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">reading</span><span class="p">[</span><span class="s2">&quot;tank_id&quot;</span><span class="p">])</span> <span class="o">&amp;</span>
<a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a>            <span class="p">(</span><span class="n">deliveries_df</span><span class="p">[</span><span class="s2">&quot;delivery_date&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">reading</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>
<a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a>        <span class="p">]</span>
<a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">future_deliveries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a>            <span class="n">next_delivery</span> <span class="o">=</span> <span class="n">future_deliveries</span><span class="p">[</span><span class="s2">&quot;delivery_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a>            <span class="n">days</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_delivery</span> <span class="o">-</span> <span class="n">reading</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a>            <span class="n">days_to_delivery</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
<a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a>            <span class="n">days_to_delivery</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a>    <span class="k">return</span> <span class="n">days_to_delivery</span>
<a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a>
<a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a><span class="n">features</span><span class="p">[</span><span class="s2">&quot;days_to_delivery&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_days_to_delivery</span><span class="p">(</span><span class="n">readings</span><span class="p">,</span> <span class="n">deliveries</span><span class="p">)</span>
<a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a><span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a>
<a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a><span class="c1"># STEP 4: Train Model</span>
<a id="__codelineno-7-86" name="__codelineno-7-86" href="#__codelineno-7-86"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-87" name="__codelineno-7-87" href="#__codelineno-7-87"></a><span class="n">X</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;days_to_delivery&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-7-88" name="__codelineno-7-88" href="#__codelineno-7-88"></a><span class="n">y</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s2">&quot;days_to_delivery&quot;</span><span class="p">]</span>
<a id="__codelineno-7-89" name="__codelineno-7-89" href="#__codelineno-7-89"></a>
<a id="__codelineno-7-90" name="__codelineno-7-90" href="#__codelineno-7-90"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-7-91" name="__codelineno-7-91" href="#__codelineno-7-91"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<a id="__codelineno-7-92" name="__codelineno-7-92" href="#__codelineno-7-92"></a><span class="p">)</span>
<a id="__codelineno-7-93" name="__codelineno-7-93" href="#__codelineno-7-93"></a>
<a id="__codelineno-7-94" name="__codelineno-7-94" href="#__codelineno-7-94"></a><span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span>
<a id="__codelineno-7-95" name="__codelineno-7-95" href="#__codelineno-7-95"></a>    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
<a id="__codelineno-7-96" name="__codelineno-7-96" href="#__codelineno-7-96"></a>    <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-7-97" name="__codelineno-7-97" href="#__codelineno-7-97"></a>    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-7-98" name="__codelineno-7-98" href="#__codelineno-7-98"></a>    <span class="n">subsample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<a id="__codelineno-7-99" name="__codelineno-7-99" href="#__codelineno-7-99"></a>    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<a id="__codelineno-7-100" name="__codelineno-7-100" href="#__codelineno-7-100"></a><span class="p">)</span>
<a id="__codelineno-7-101" name="__codelineno-7-101" href="#__codelineno-7-101"></a>
<a id="__codelineno-7-102" name="__codelineno-7-102" href="#__codelineno-7-102"></a><span class="c1"># Cross-validation</span>
<a id="__codelineno-7-103" name="__codelineno-7-103" href="#__codelineno-7-103"></a><span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-7-104" name="__codelineno-7-104" href="#__codelineno-7-104"></a>                            <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_absolute_error&#39;</span><span class="p">)</span>
<a id="__codelineno-7-105" name="__codelineno-7-105" href="#__codelineno-7-105"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CV MAE: </span><span class="si">{</span><span class="o">-</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">cv_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
<a id="__codelineno-7-106" name="__codelineno-7-106" href="#__codelineno-7-106"></a>
<a id="__codelineno-7-107" name="__codelineno-7-107" href="#__codelineno-7-107"></a><span class="c1"># Fit final model</span>
<a id="__codelineno-7-108" name="__codelineno-7-108" href="#__codelineno-7-108"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-7-109" name="__codelineno-7-109" href="#__codelineno-7-109"></a>
<a id="__codelineno-7-110" name="__codelineno-7-110" href="#__codelineno-7-110"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-111" name="__codelineno-7-111" href="#__codelineno-7-111"></a><span class="c1"># STEP 5: Evaluate</span>
<a id="__codelineno-7-112" name="__codelineno-7-112" href="#__codelineno-7-112"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-113" name="__codelineno-7-113" href="#__codelineno-7-113"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-7-114" name="__codelineno-7-114" href="#__codelineno-7-114"></a><span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-7-115" name="__codelineno-7-115" href="#__codelineno-7-115"></a><span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-7-116" name="__codelineno-7-116" href="#__codelineno-7-116"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
<a id="__codelineno-7-117" name="__codelineno-7-117" href="#__codelineno-7-117"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
<a id="__codelineno-7-118" name="__codelineno-7-118" href="#__codelineno-7-118"></a>
<a id="__codelineno-7-119" name="__codelineno-7-119" href="#__codelineno-7-119"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-120" name="__codelineno-7-120" href="#__codelineno-7-120"></a><span class="c1"># STEP 6: Save Model for Deployment</span>
<a id="__codelineno-7-121" name="__codelineno-7-121" href="#__codelineno-7-121"></a><span class="c1"># ============================================================</span>
<a id="__codelineno-7-122" name="__codelineno-7-122" href="#__codelineno-7-122"></a><span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;delivery_predictor_v1.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-7-123" name="__codelineno-7-123" href="#__codelineno-7-123"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model saved for deployment&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Model Improvement Strategies</p>
<p>If initial model accuracy is insufficient:</p>
<ol>
<li><strong>Add more features</strong>: Weather data, holidays, customer-specific patterns</li>
<li><strong>Use more data</strong>: Longer training history improves seasonal pattern capture</li>
<li><strong>Try different algorithms</strong>: Random Forest, XGBoost, LightGBM, or LSTM</li>
<li><strong>Per-tank models</strong>: Individual models for high-volume tanks, grouped models for similar tanks</li>
<li><strong>Ensemble methods</strong>: Combine multiple model predictions for robustness</li>
</ol>
</div>
<hr />
<h2 id="1314-future-ai-roadmap">13.14 Future AI Roadmap</h2>
<p>The application of AI to tank monitoring is still in its early stages. Several emerging capabilities will reshape the field over the coming years.</p>
<h3 id="near-term-1-2-years">Near-Term (1-2 Years)</h3>
<table>
<thead>
<tr>
<th>Capability</th>
<th>Description</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Automated anomaly classification</strong></td>
<td>AI not only detects anomalies but classifies them (leak, theft, sensor error, delivery)</td>
<td>Reduces investigation time from hours to minutes</td>
</tr>
<tr>
<td><strong>Fleet-wide pattern recognition</strong></td>
<td>Identify patterns across thousands of tanks simultaneously</td>
<td>Discover systemic issues before they affect individual tanks</td>
</tr>
<tr>
<td><strong>Weather-integrated forecasting</strong></td>
<td>Automatic incorporation of weather forecasts into demand predictions</td>
<td>15-25% improvement in forecast accuracy</td>
</tr>
<tr>
<td><strong>Natural language reporting</strong></td>
<td>AI generates written analysis of fleet status in plain English</td>
<td>Executives get actionable summaries without dashboard navigation</td>
</tr>
</tbody>
</table>
<h3 id="medium-term-3-5-years">Medium-Term (3-5 Years)</h3>
<table>
<thead>
<tr>
<th>Capability</th>
<th>Description</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Fully autonomous delivery scheduling</strong></td>
<td>AI schedules all deliveries without human intervention</td>
<td>Reduces planning labor by 90%; improves delivery efficiency by 20%</td>
</tr>
<tr>
<td><strong>Predictive structural monitoring</strong></td>
<td>AI predicts tank structural degradation from indirect indicators</td>
<td>Prevents catastrophic failures; extends tank service life</td>
</tr>
<tr>
<td><strong>Multi-modal AI</strong></td>
<td>Combines level data, imagery, weather, market data, and more</td>
<td>Holistic understanding of tank operations</td>
</tr>
<tr>
<td><strong>Federated learning</strong></td>
<td>Train ML models across customer data without sharing raw data</td>
<td>Better models while preserving data privacy</td>
</tr>
</tbody>
</table>
<h3 id="long-term-5-10-years">Long-Term (5-10 Years)</h3>
<table>
<thead>
<tr>
<th>Capability</th>
<th>Description</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Autonomous supply chains</strong></td>
<td>End-to-end automation from demand sensing to delivery</td>
<td>Minimal human intervention in routine operations</td>
</tr>
<tr>
<td><strong>Self-healing sensor networks</strong></td>
<td>AI automatically reconfigures network when sensors fail</td>
<td>Near-zero monitoring downtime</td>
</tr>
<tr>
<td><strong>Digital twin ecosystems</strong></td>
<td>Complete virtual replica of entire supply chain</td>
<td>Full simulation capability for strategic planning</td>
</tr>
</tbody>
</table>
<pre class="mermaid"><code>timeline
    title AI Capability Roadmap for Tank Monitoring
    section Near-Term
        2025 : Anomaly classification
             : Weather-integrated forecasts
             : NLP interfaces
    section Medium-Term
        2027 : Autonomous scheduling
             : Structural prediction
             : Federated learning
    section Long-Term
        2030 : Autonomous supply chains
             : Self-healing networks
             : Digital twin ecosystems</code></pre>
<hr />
<h2 id="chapter-13-summary">Chapter 13 Summary</h2>
<p>This chapter explored how artificial intelligence and machine learning are transforming tank monitoring from passive data collection to proactive, predictive intelligence:</p>
<ul>
<li><strong>AI enables a progression</strong> from descriptive ("what happened?") to autonomous ("do it automatically") capabilities</li>
<li><strong>Machine learning fundamentals</strong> -- supervised, unsupervised, and reinforcement learning -- each have specific applications in tank monitoring</li>
<li><strong>Anomaly detection</strong> using statistical methods and ML algorithms can identify leaks, theft, and sensor failures</li>
<li><strong>Predictive maintenance</strong> reduces costs by 70% compared to reactive approaches by predicting failures before they occur</li>
<li><strong>Delivery prediction</strong> and <strong>demand forecasting</strong> use time-series models to optimize logistics</li>
<li><strong>Digital twins</strong> create virtual replicas of physical tanks for simulation and optimization</li>
<li><strong>Edge AI</strong> on gateway devices enables local intelligence for low-latency, offline-capable operation</li>
<li><strong>NLP interfaces</strong> allow natural language queries against tank data</li>
<li><strong>Computer vision</strong> complements level monitoring for inspection and leak location</li>
<li><strong>Python analytics</strong> capabilities enable custom model development on TankScan data</li>
<li>The <strong>AI roadmap</strong> points toward increasingly autonomous tank monitoring and supply chain management</li>
</ul>
<hr />
<h2 id="review-questions">Review Questions</h2>
<div class="admonition question">
<p class="admonition-title">Question 1 -- Knowledge (Remember)</p>
<p>Name and briefly describe the three main categories of machine learning, and give one tank monitoring example for each.</p>
<details class="success">
<summary>Answer</summary>
<ol>
<li>
<p><strong>Supervised learning</strong>: The model learns from labeled examples (input-output pairs). Tank monitoring example: predicting days until delivery needed, where the input is current level, consumption rate, etc., and the output is the known delivery date from historical records.</p>
</li>
<li>
<p><strong>Unsupervised learning</strong>: The model finds hidden patterns in data without labels. Tank monitoring example: clustering tanks into groups with similar consumption patterns to identify segment-specific behaviors.</p>
</li>
<li>
<p><strong>Reinforcement learning</strong>: An agent learns by taking actions in an environment and receiving rewards or penalties. Tank monitoring example: a route optimization agent that learns the most efficient delivery sequence through trial and error, adapting to changing conditions.</p>
</li>
</ol>
</details>
</div>
<div class="admonition question">
<p class="admonition-title">Question 2 -- Comprehension (Understand)</p>
<p>Explain why a simple average consumption rate is insufficient for predicting delivery needs, and describe two more sophisticated approaches that address its limitations.</p>
<details class="success">
<summary>Answer</summary>
<p>A simple average consumption rate fails because it assumes consumption is constant over time. In reality, consumption varies significantly due to <strong>seasonality</strong> (propane usage is much higher in winter), <strong>day-of-week effects</strong> (industrial tanks consume more on weekdays), and <strong>trends</strong> (growing or declining business). A simple average over a year would underpredict winter needs and overpredict summer needs.</p>
<p>Two better approaches:
1. <strong>Exponential Weighted Moving Average</strong>: Weights recent data more heavily using <span class="arithmatex">\(R_{weighted} = \frac{\sum w_i \cdot r_i}{\sum w_i}\)</span> where <span class="arithmatex">\(w_i = \alpha^{n-i}\)</span>. This adapts quickly to changing consumption patterns.
2. <strong>Facebook Prophet (or similar time-series model)</strong>: Decomposes consumption into trend, seasonality, and residual components, and can incorporate external regressors like temperature. This handles complex seasonal patterns and holidays automatically.</p>
</details>
</div>
<div class="admonition question">
<p class="admonition-title">Question 3 -- Application (Apply)</p>
<p>A sensor's battery voltage has been declining at a rate of 0.015V per month. The current voltage is 3.25V and the sensor stops functioning at 2.80V. Build a simple prediction for when this sensor will fail, and describe what additional data would improve the prediction.</p>
<details class="success">
<summary>Answer</summary>
<p><strong>Simple linear prediction:</strong>
- Remaining voltage: <span class="arithmatex">\(3.25V - 2.80V = 0.45V\)</span>
- Months until failure: <span class="arithmatex">\(0.45V \div 0.015V/month = 30\)</span> months</p>
<p>The sensor is predicted to fail in approximately <strong>30 months</strong> (2.5 years).</p>
<p><strong>Additional data to improve prediction:</strong>
- <strong>Temperature history</strong>: Battery voltage decline accelerates in extreme temperatures. Knowing the seasonal temperature profile would reveal that winter months might drain the battery 2-3x faster.
- <strong>Transmission frequency</strong>: More frequent readings drain the battery faster. If the sensor's reporting interval changes, the decline rate will change.
- <strong>Signal strength (RSSI)</strong>: Poor signal requires higher transmission power, draining the battery faster. If the sensor's RF environment deteriorates, battery drain accelerates.
- <strong>Historical failure data from similar sensors</strong>: Other sensors of the same model in similar environments provide empirical failure distributions.
- <strong>Non-linear decline patterns</strong>: Battery voltage often declines exponentially near end-of-life, not linearly. A model trained on actual battery discharge curves would predict a shorter remaining life.</p>
</details>
</div>
<div class="admonition question">
<p class="admonition-title">Question 4 -- Analysis (Analyze)</p>
<p>Compare cloud-based AI and edge AI for anomaly detection in tank monitoring. Under what specific conditions would you recommend edge AI over cloud AI, and vice versa?</p>
<details class="success">
<summary>Answer</summary>
<p><strong>Recommend Edge AI when:</strong>
- <strong>Connectivity is unreliable</strong>: Remote sites with intermittent cellular coverage need local anomaly detection to ensure critical alerts are not delayed by network outages
- <strong>Latency is critical</strong>: Safety-critical applications (C1D1 environments) where even seconds of delay are unacceptable
- <strong>Bandwidth costs are high</strong>: Satellite-connected sites where transmitting every reading is expensive; edge AI can filter and only transmit anomalies
- <strong>Scale requires cost optimization</strong>: Thousands of sensors where cloud compute costs for real-time anomaly detection become significant
- <strong>Privacy or regulatory constraints</strong>: Industries where data must be processed locally before any cloud transmission</p>
<p><strong>Recommend Cloud AI when:</strong>
- <strong>Model complexity is high</strong>: Sophisticated models (LSTMs, large ensembles) that exceed gateway processing capacity
- <strong>Cross-tank analysis is needed</strong>: Patterns that span multiple tanks or sites require centralized data
- <strong>Rapid model iteration is needed</strong>: Cloud models can be updated instantly; edge models require OTA firmware updates
- <strong>Rich feature sets are available</strong>: Cloud can combine tank data with weather, ERP, and market data for richer analysis
- <strong>Historical context is important</strong>: Anomaly detection that considers months of history requires cloud-scale storage</p>
<p><strong>Optimal approach</strong>: Use edge AI for immediate, safety-critical anomaly detection with simple models, and cloud AI for deeper, context-rich analysis with complex models. The two are complementary, not competing.</p>
</details>
</div>
<div class="admonition question">
<p class="admonition-title">Question 5 -- Synthesis (Create)</p>
<p>Design an AI-powered system that automatically detects fuel theft from monitored tanks. Describe the data inputs, algorithm approach, alert logic, and how you would handle false positives.</p>
<details class="success">
<summary>Answer</summary>
<p><strong>System Design: AI-Powered Fuel Theft Detection</strong></p>
<p><strong>Data Inputs:</strong>
- Real-time tank level readings (every 15 minutes)
- Historical consumption patterns (baseline)
- Scheduled delivery records (to exclude delivery events)
- Time of day and day of week
- Site access logs (if available)
- Weather data (temperature for thermal expansion compensation)</p>
<p><strong>Algorithm Approach:</strong>
1. <strong>Baseline modeling</strong>: Train a time-series model on 90+ days of historical data to establish normal consumption patterns for each tank. The model learns typical weekday vs. weekend rates, daily patterns (e.g., consumption during business hours only), and seasonal trends.
2. <strong>Temperature compensation</strong>: Apply thermal expansion correction to eliminate false signals from temperature-driven level changes.
3. <strong>Event classification</strong>: For each significant level change, classify as: (a) normal consumption, (b) scheduled delivery, (c) anomalous decrease, or (d) anomalous increase.
4. <strong>Theft scoring</strong>: Score anomalous decreases based on: magnitude of unexpected drop, time of occurrence (nighttime/weekend = higher score), rate of decrease (theft is typically faster than normal consumption), and whether it matches known theft patterns from historical confirmed incidents.</p>
<p><strong>Alert Logic:</strong>
- Score &gt; 0.8: Immediate alert to security and operations
- Score 0.5-0.8: Alert to operations for investigation within 24 hours
- Score 0.3-0.5: Log for review in weekly anomaly report
- Score &lt; 0.3: Normal variation, no action</p>
<p><strong>False Positive Management:</strong>
- <strong>Feedback loop</strong>: Every alert includes "Confirm theft" / "Not theft" buttons. Operator feedback retrains the model.
- <strong>Contextual enrichment</strong>: Before alerting, check for known maintenance activities, emergency consumption events, or meter calibration that could explain the drop.
- <strong>Graduated alerting</strong>: Start with low-confidence alerts to operations only (not police/security) to build operator trust before escalating alert severity.
- <strong>Seasonal recalibration</strong>: Retrain baseline models quarterly to account for evolving consumption patterns.</p>
</details>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>